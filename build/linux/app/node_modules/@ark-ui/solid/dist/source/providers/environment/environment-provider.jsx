import { getDocument, getWindow } from '@zag-js/dom-query';
import { Show, createMemo, createSignal } from 'solid-js';
import { runIfFn } from '../../utils/run-if-fn';
import { EnvironmentContextProvider } from './use-environment-context';
export const EnvironmentProvider = (props) => {
    const [spanRef, setSpanRef] = createSignal();
    const getRootNode = () => runIfFn(props.value) ?? spanRef()?.ownerDocument ?? document;
    const environment = createMemo(() => ({
        getRootNode,
        getDocument: () => getDocument(getRootNode()),
        getWindow: () => getWindow(getRootNode()),
    }));
    return (<EnvironmentContextProvider value={environment}>
      {props.children}
      <Show when={!props.value}>
        <span hidden ref={setSpanRef}/>
      </Show>
    </EnvironmentContextProvider>);
};
